1 WIDTH 80
10 GOSUB TAB,28:PRINT "AMAZING PROGRAM" :REM
20 GOSUB TAB,15:PRINT "CREATIVE COMPUTING MORRISTOUN, NEW JERSEY" :REM
30 PRINT:PRINT:PRINT:PRINT
90 PRINT "WHAT ARE YOUR WIDTH AND LENGTH" :REM
92 H=VAL(INPUT$()) :REM
94 V=VAL(INPUT$()) :REM
102 IF H!=1 AND V!=1 THEN 110 :REM
104 PRINT "MEANINOLESS DIMENSIONS. TRY AGAIN.":GOTO 90 :REM
110 DIM W(H,V),Y(H,V)
120 PRINT
130 PRINT
140 PRINT
150 PRINT
152 GOSUB INIRND :REM
160 Q=0:Z=0:X=INT(GOSUB#(RND_,1)*FLOAT#(H)+1) :REM
165 FOR I=1 TO H
170 IF I=X THEN 173 
171 PRINT ",--";:GOTO 180
173 PRINT ",  ";
180 NEXT :REM
190 PRINT ","
195 C=1:W(X,1)=C:C=C+1
200 R=X:S=1:GOTO 260
210 IF R!=H THEN 240 :REM
215 If S!=V THEN 230 :REM
220 R=1:S=1:GOTO 250
230 R=1:S=S+1:GOTO 250
240 R=R+1
250 IF W(R,S)=0 THEN 210
260 IF R-1=0 THEN 530
265 IF W(R-1,S)!=0 THEN 530 :REM
270 IF S-1=0 THEN 390
280 IF W(R,S-1) !=0 THEN 390 :REM
290 IF R=H THEN 330
300 IF W(R+1,S)!=0 THEN 330 :REM
310 X=INT(GOSUB#(RND_,1)*3+1) :REM
REM 320 ON X GOTO 790,820,860
320 IF X=1 THEN 790   :REM
322 IF X=2 THEN 820   :REM
324 IF X=3 THEN 860   :REM
330 IF S!=V THEN 340 :REM
334 IF Z=1 THEN 370
338 Q=1:GOTO 350
340 IF W(R,S+1)!=O THEN 370 :REM
350 X=INT(GOSUB#(RND_,1)*3+1) :REM
REM 360 ON X GOTO 790,820,910
360 IF X=1 THEN 790   :REM
362 IF X=2 THEN 820   :REM
364 IF X=3 THEN 910   :REM
370 X=INT(GOSUB#(RND_,1)*2+1) :REM
REM 380 ON X GOTO 790,820
380 IF X=1 THEN 790   :REM
382 IF X=2 THEN 820   :REM
390 IF R=H THEN 470
400 IF W(R+1,S)!=0 THEN 470 :REM
405 IF S!=V THEN 420 :REM
410 IF Z=1 THEN 450
415 Q=1:GOTO 430
420 IF W(R,S+1)!=0 THEN 450
430 X=INT(GOSUB#(RND_,1)*3+1) :REM
REM 440 ON X GOTO 790,860,910
440 GOTO 440+X :REM
441 GOTO 790   :REM
442 GOTO 860   :REM
443 GOTO 910   :REM
450 X=INT(GOSUB#(RND_,1)*2+1) :REM
REM 460 ON X GOTO 790,860
460 IF X=1 THEN 790   :REM
462 IF X=2 THEN 860   :REM
470 IF S!=V THEN 490 :REM
480 IF Z=1 THEN 520
485 Q=1:GOTO 500
490 IF W(R,S+1)!=0 THEN 520 :REM
500 X=INT(GOSUB#(RND_,1)*2+1) :REM
REM 510 ON X GOTO 790,910
510 IF X=1 THEN 790   :REM
512 IF X=2 THEN 910   :REM
520 GOTO 790
530 IF S-1=0 THEN 670
540 IF W(R,S-1)!=0 THEN 670 :REM
545 IF R=H THEN 610
547 IF W(R+1,S)!=0 THEN 610 :REM
550 IF S!=V THEN 560 :REM
552 IF Z=1 THEN 590
554 Q=1:GOTO 570
560 IF W(R,S+1)!=0 THEN 590 :REM
570 X=INT(GOSUB#(RND_,1)*3+1) :REM
REM 580 ON X GOTO 820,860,910
580 IF X=1 THEN 820   :REM
582 IF X=2 THEN 860   :REM
584 IF X=3 THEN 910   :REM
590 X=INT(GOSUB#(RND_,1)*2+1) :REM
REM 600 ON X GOTO 820,860
600 IF X=1 THEN 820   :REM
602 IF X=2 THEN 860   :REM
610 IF S!=V THEN 630 :REM
620 IF Z=1 THEN 660
625 Q=1:GOTO 640
630 IF W(R,S+1)!=0 THEN 660 :REM
640 X=INT(GOSUB#(RND_,I)*2+1) :REM
REM 650 ON X GOTO 820,910
650 IF X=1 THEN 820   :REM
652 IF X=2 THEN 910   :REM
660 GOTO 820
670 IF R=H THEN 740
680 IF W(R+1,S)!=0 THEN 740 :REM
685 IF S!=V THEN 700 :REM
690 IF Z=1 THEN 730
695 Q=1:GOTO 830
700 IF W(R,S+1)!=0 THEN 730 :REM
710 X=INT(GOSUB#(RND_,1)*2+1) :REM
REM 720 ON X GOTO 860.910
720 GOTO 720+X :REM
721 GOTO 860   :REM
722 GOTO 910   :REM
730 GOTO 860
740 IF S!=V THEN 760 :REM
750 IF Z=1 THEN 780
755 Q=1:GOTO 770
760 IF W(R,S+1)!=0 THEN 780 :REM
770 GOTO 910
780 GOTO 1000
790 W(R-1,S)=C
800 C=C+1:Y(R-1,S)=2:R=R-1
810 IF C=H*V+1 THEN 1010
815 Q=0:GOTO 260 
820 W(R,S-1)=C
830 C=C+1
840 Y(R,S-1)=1:S=S-1:IF C=H*V+1 THEN 1010
850 Q=0:GOTO 260
860 W(R+1,S)=C
870 C=C+1:IF Y(R,S)=0 THEN 880
875 Y(R,S)=3:GOTO 890
880 Y(R,S)=2
890 R=R+1
900 IF C=H*V+1 THEN 1010
905 GOTO 530
910 IF Q=1 THEN 960
920 W(R,S+1)=C:C=C+1:IF Y(R,S)=0 THEN 940
930 Y(R,S)=3:GOTO 950
940 Y(R,S)=1
950 S=S+1:IF C=H*V+1 THEN 1010
955 GOTO 260
960 Z=1
970 IF Y(R,S)=0 THEN 980
975 Y(R,S)=3:Q=0:GOTO 1000
980 Y(R,S)=1:Q=0:R=1:S=1:GOTO 250
1000 GOTO 210 
1010 FOR J=1 TO V
1011 PRINT "I";
1012 FOR I=1 TO H
1013 IF Y(I,J)<2 THEN 1030
1020 PRINT "   ";
1021 GOTO 1040
1030 PRINT "  I";
1040 NEXT
1041 PRINT 
1043 FOR I=1 TO H
1045 IF Y(I,J)=0 THEN 1060
1050 IF Y(I,J)=2 THEN 1060
1051 PRINT ":  "; 
1052 GOTO 1070
1060 PRINT ":--";
1070 NEXT
1071 PRINT ","
1072 NEXT
1073 END


REM Subroutines For MachiKania

LABEL TAB
VAR I,J
J=ARGS(1)
FOR I=0 TO J-1
  PRINT " ";
NEXT
RETURN

LABEL INIRND
POKE32 SYSTEM(101),CORETIMER()
RETURN

LABEL RND_
VAR I,J
I=ARGS(1)
J#=FLOAT#(RND()*I)/32767
RETURN J#
